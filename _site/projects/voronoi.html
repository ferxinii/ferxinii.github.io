<!DOCTYPE html>

<html lang="en" class="h-100">

<head>

  
  
  

  

  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <meta property="og:type" content="website">
  <meta property="og:title" content="3D Voronoi diagrams">
  <meta property="og:description" content="Construct bounded 3D Voronoi diagrams in an arbitrary polyhedron.">
  <meta property="og:image" content="/assets/images/projects/voronoi/front.png">

  <title>3D Voronoi diagrams</title>
  <meta name="description" content="Construct bounded 3D Voronoi diagrams in an arbitrary polyhedron.">

  <link rel="shortcut icon" type="image/x-icon" href="/assets/favicon.ico">

  <!-- Theme style -->
  <script src="/assets/js/theme.js"></script>

  <!-- Font Awesome CDN -->
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.4/css/all.css">

  <!-- Bootstrap CSS CDN -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/css/bootstrap.min.css">

  <!-- Animate CSS CDN -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.7.0/animate.css">

  <!-- Custom CSS -->
  <link rel="stylesheet" href="/assets/css/style.css">

  <!-- KaTeX  -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
  <script defer src="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.js" integrity="sha384-g7c+Jr9ZivxKLnZTDUhnkOnsh30B4H0rpLUpJ4jAIKs4fnJI+sEnkvrMWph2EDg4" crossorigin="anonymous"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/contrib/auto-render.min.js" integrity="sha384-mll67QQFJfxn0IYznZYonOWZ644AWYC+Pt2cHqMaRhXVrursRwvLnLaebdGIlYNa" crossorigin="anonymous"></script>
  <script>
      document.addEventListener("DOMContentLoaded", function() {
          renderMathInElement(document.body, {
              // ...options...
          });
      });
  </script>

  <!-- <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css"> -->
  <!-- <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"></script> -->
  <!-- <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js" -->
  <!-- onload="renderMathInElement(document.body);"></script> -->

</head>


<body class="h-100 d-flex flex-column">
<!-- <body class="page.layout"> -->

  <main class="flex-shrink-0 container mt-5">
    <nav class="navbar navbar-expand-lg navbar-themed">

  <a class="navbar-brand" href="/"><h5><b>ferxinii</b></h5></a>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation">
    <i class="fas fa-1x fa-bars text-themed"></i>
  </button>

  <div class="collapse navbar-collapse" id="navbarNavAltMarkup">
    <div class="navbar-nav ml-auto"><a class="nav-item nav-link active" href="/projects/">Projects</a>

      <a class="nav-item nav-link " href="/blog/">Blog</a>

      <a class="nav-item nav-link " href="/about/">About</a>

      

      <span id="theme-toggler" class="nav-item nav-link" role="button" onclick="toggleTheme()"></span>
    </div>
  </div>

</nav>
    <div class="col-lg-10 mx-auto mt-5 markdown-body">
  <h2 id="robust-delaunay-triangulation">Robust Delaunay triangulation</h2>
<p>Given a set of seeds, to find its Voronoi diagram we first construct the associated Delaunay triangulation. To do so, we have implemented in C the algorithm described in the paper <em>Computing the 3D Voronoi Diagram Robustly: An Easy Explanation</em> by Hugo Ledoux (<a href="https://gdmc.nl/publications/2007/Computing_3D_Voronoi_Diagram.pdf" target="_blank">link</a>).</p>

<p>The idea of the algorithm is to iteratively add each seed and at each step restore local Delaunayness by using <em>Pachner flips</em> (or <em>bistellar flips</em>).</p>

<div style="display: flex; flex-wrap: wrap; justify-content: center; gap: 10px;">
  <p><img src="/assets/images/projects/voronoi/pachner.png" alt="Pachner flips" width="700" height="auto" /></p>
</div>

<p>When the Delaunay triangulation is constructed, extracting the corresponding Voronoi diagram is trivial due to the duality relationships between the Delaunay and Voronoi constructions. However, the resulting Voronoi diagram is unbounded.</p>

<h2 id="bounding-polyhedron">Bounding polyhedron</h2>
<p>In order to bound the diagram appropriately with an arbitrary polyhedron, we use a <em>mirroring</em> appraoch. The idea is to enlarge the set of seeds by mirroring the necessary sites accross each face of the bounding polyehdron. Then, the Delaunay triangulation of this extended set of seeds is computed. Finally, we extract the dual Voronoi cells in the interior of the polyhedron, which will be naturally bounded.</p>

<p>The next figure (from <a href="https://stackoverflow.com/questions/28665491/getting-a-bounded-polygon-coordinates-from-voronoi-cells">this</a> StackOverflow discussion, comment by <em>Flabetvibes</em>) shows an example of this principle in the plane, with the goal of bounding the cells corresponding to the points inside the red box.</p>

<div style="display: flex; flex-wrap: wrap; justify-content: center; gap: 10px;">
  <p><img src="/assets/images/projects/voronoi/mirroring.png" alt="Mirroring in 2D" width="400" height="auto" /></p>
</div>

<h2 id="example-in-lung-geometry">Example in lung geometry</h2>
<p>This code has been used to construct secondary pulmonary lobules inside a lung geometry. By playing with the distribution of seeds inside the lung, we can obtain different morphologies and distributions of lobule volumes.</p>

<div style="display: flex; flex-wrap: wrap; justify-content: center; gap: 10px;">
<img src="/assets/images/projects/voronoi/R_v2.png" alt="Example right lung" width="400" height="auto" />
<img src="/assets/images/projects/voronoi/L_v4.png" alt="Example left lung" width="400" height="auto" />
</div>

<center>
<a class="m-1 btn btn-outline-primary btn-2 " href="https://github.com/ferxinii/voronoi_3d" target="_blank" rel="noopener noreferrer">
  GitHub
</a>

<!-- <a class="m-1 btn btn-outline-primary btn-2 " href="https://github.com/ferxinii/voronoi_3d"> -->
<!--   GitHub -->
<!-- </a> -->

</center>

</div>
  </main>
  <footer class="mt-auto py-3 text-center">

  <!-- <small class="text-muted mb-2"> -->
  <!--   <i class="fas fa-code"></i> with <i class="fas fa-heart"></i> -->
  <!--   by <strong>Fernando Muñoz</strong> -->
  <!-- </small> -->

  <div class="container-fluid justify-content-center"><a class="social mx-1"  href="https://www.github.com/ferxinii"
       style="color: #6c757d"
       onMouseOver="this.style.color='#333333'"
       onMouseOut="this.style.color='#6c757d'">
      <i class="fab fa-github fa-1x"></i>
    </a><a class="social mx-1"  href="https://www.linkedin.com/in/fernandomuñozpuente"
       style="color: #6c757d"
       onMouseOver="this.style.color='#007bb5'"
       onMouseOut="this.style.color='#6c757d'">
      <i class="fab fa-linkedin-in fa-1x"></i>
    </a>

</div>

  <!---->
  <!---->
  <!-- <small id="attribution"> -->
  <!--   theme <a href="https://github.com/yousinix/portfolYOU">portfolYOU</a> -->
  <!-- </small> -->

</footer>


  
  <!-- GitHub Buttons -->
<script async defer src="https://buttons.github.io/buttons.js"></script>

<!-- jQuery CDN -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

<!-- Popper.js CDN -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.6/umd/popper.min.js"></script>

<!-- Bootstrap JS CDN -->
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>

<!-- wow.js CDN & Activation -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/wow/1.1.2/wow.js"></script>
<script> new WOW().init(); </script>

<!-- Initialize all tooltips -->
<script>
$(function () {
    $('[data-toggle="tooltip"]').tooltip()
})
</script>
</body>

</html>
